# 医疗系统远程服务器测试说明

## 测试环境

- **目标服务器**: 8.140.225.6:55000
- **协议**: TCP Socket + JSON
- **测试工具**: Python 3.x

## 测试脚本说明

### 1. 快速测试 - `quick_test.py`

**用途**: 快速验证服务器基本功能
**特点**: 简单直接，不依赖复杂模块

```bash
python quick_test.py
```

**测试内容**:
- ✅ 服务器连接测试
- 👤 用户登录验证
- 👨‍⚕️ 医生信息查询
- 🗄️ SQL查询功能
- 📅 预约创建功能

### 2. 完整测试 - `remote_test.py`

**用途**: 全面的功能和性能测试
**特点**: 完整的测试套件，包含并发和性能测试

```bash
python remote_test.py
```

**测试内容**:
- 🔗 基础连接测试
- 👤 用户认证系统
- 📝 患者注册功能
- 👨‍⚕️ 医生信息管理
- 📅 预约管理系统
- 🗄️ SQL查询接口
- ⚠️ 错误处理机制
- 🔄 并发连接测试 (5个线程)
- ⚡ 性能测试 (10次请求)

**输出**: 生成详细的JSON格式测试报告

### 3. 压力测试 - `stress_test.py`

**用途**: 服务器性能和稳定性测试
**特点**: 高并发、大量请求、性能分析

```bash
python stress_test.py
```

**测试选项**:
1. 轻量测试: 10并发 × 5请求 = 50总请求
2. 中等测试: 20并发 × 10请求 = 200总请求
3. 重度测试: 50并发 × 20请求 = 1000总请求
4. 顺序测试: 100个顺序请求
5. 自定义测试: 用户自定义参数

**性能指标**:
- 📊 成功率统计
- ⚡ 响应时间分析 (平均/中位数/95%/99%)
- 🚀 吞吐量计算
- ❌ 错误分析

## 测试数据

### 预置测试用户

**患者账户**:
- 用户名: `13800138000`
- 密码: `hash_patient1`
- 姓名: 张三

**医生账户**:
- 用户名: `DOC001`
- 密码: `hash_doctor1`
- 姓名: 王医生
- 科室: 内科

### 测试用例

#### 1. 用户登录测试
```json
{
  "login": true,
  "user_name": "13800138000",
  "password": "hash_patient1"
}
```

**预期响应**: `"verificationSuccess"`

#### 2. 医生信息查询
```json
{
  "query_doctor_info": true,
  "doctor_name": "王医生"
}
```

**预期响应**: 包含医生详细信息的JSON对象

#### 3. 预约创建
```json
{
  "create_appointment": true,
  "patient_phone": "13800138000",
  "doctor_name": "王医生",
  "appointment_time": "2024-03-20 14:00:00",
  "fee_paid": 1
}
```

**预期响应**: 包含预约ID和排队号的成功响应

#### 4. SQL查询
```json
{
  "sql_query": "SELECT COUNT(*) as total_users FROM users"
}
```

**预期响应**: 包含查询结果的结构化数据

## 使用步骤

### 第一步: 环境准备
```bash
# 确保Python环境
python --version

# 检查网络连接
ping 8.140.225.6
```

### 第二步: 快速验证
```bash
# 运行快速测试
python quick_test.py
```

### 第三步: 完整测试
```bash
# 运行完整测试套件
python remote_test.py
```

### 第四步: 性能测试
```bash
# 运行压力测试
python stress_test.py
```

## 测试结果解读

### 成功指标
- ✅ **连接成功**: 能够建立TCP连接
- ✅ **响应正确**: 返回预期的JSON格式响应
- ✅ **功能正常**: 各业务功能按预期工作
- ✅ **性能良好**: 响应时间 < 100ms，成功率 > 95%

### 异常处理
- ❌ **连接超时**: 检查网络连接和服务器状态
- ❌ **响应错误**: 检查请求格式和服务器日志
- ❌ **功能异常**: 检查数据库状态和业务逻辑
- ❌ **性能问题**: 检查服务器负载和资源使用

## 常见问题

### Q1: 连接被拒绝
**原因**: 服务器未启动或端口被占用
**解决**: 
```bash
# 检查端口状态
telnet 8.140.225.6 55000
# 或
nc -zv 8.140.225.6 55000
```

### Q2: 响应超时
**原因**: 网络延迟或服务器处理慢
**解决**: 增加超时时间或检查网络状况

### Q3: 认证失败
**原因**: 用户名密码错误或数据库问题
**解决**: 检查测试数据或服务器日志

### Q4: 并发测试失败
**原因**: 服务器并发处理能力不足
**解决**: 降低并发数或优化服务器配置

## 测试报告

### 自动生成报告
所有测试脚本都会自动生成JSON格式的详细报告:

- `test_report_YYYYMMDD_HHMMSS.json` - 完整测试报告
- `stress_test_result_YYYYMMDD_HHMMSS.json` - 压力测试报告

### 报告内容
```json
{
  "server": "8.140.225.6:55000",
  "test_time": "2024-01-01T12:00:00",
  "summary": {
    "total_tests": 10,
    "passed_tests": 9,
    "failed_tests": 1,
    "success_rate": "90.0%"
  },
  "detailed_results": [...]
}
```

## 性能基准

### 预期性能指标
- **响应时间**: < 100ms (平均)
- **并发处理**: 50+ 同时连接
- **吞吐量**: 100+ 请求/秒
- **成功率**: > 95%
- **内存使用**: < 100MB

### 压力测试建议
1. **轻量测试**: 日常功能验证
2. **中等测试**: 性能基准测试
3. **重度测试**: 极限性能测试
4. **长时间测试**: 稳定性验证

## 注意事项

### 测试环境
- 确保网络连接稳定
- 避免在生产环境进行重度测试
- 注意测试数据的清理

### 数据安全
- 使用测试数据，避免真实患者信息
- 测试完成后清理临时数据
- 不要在测试中使用真实密码

### 服务器影响
- 压力测试可能影响服务器性能
- 建议在低峰时段进行测试
- 监控服务器资源使用情况

## 专项功能测试

### 医生注册测试

#### 快速医生注册测试 - `quick_doctor_test.py`
**用途**: 快速验证医生注册核心功能
```bash
python quick_doctor_test.py
```

**测试内容**:
- ✅ 正常医生注册
- ✅ 注册后登录验证
- ✅ 注册后信息查询
- ✅ 重复工号检测
- ✅ 无效数据检测

#### 完整医生注册测试 - `test_doctor_registration.py`
**用途**: 全面的医生注册功能测试
```bash
python test_doctor_registration.py
```

**测试内容**:
- 👨‍⚕️ 多种有效注册场景
- 🔄 重复工号错误处理
- ⚠️ 各种无效数据检测
- 🔍 注册后信息查询验证
- 📊 批量医生注册测试
- 📄 详细测试报告生成

#### Socket延迟测试 - `test_socket_delay.py`
**用途**: 验证网络连接延迟优化
```bash
python test_socket_delay.py
```

**测试内容**:
- 🔗 基本延迟功能测试
- 🔄 并发连接延迟测试
- ⏱️ 响应时间统计
- 📊 连接稳定性分析

### 测试数据参考

**医生注册JSON示例**: 查看 `doctor_registration_examples.json`
**预置测试账户**: 
- 工号: DOC001, 密码: hash_doctor1, 姓名: 王医生

---

**测试愉快！如有问题请查看服务器日志或联系开发团队。** 🚀
